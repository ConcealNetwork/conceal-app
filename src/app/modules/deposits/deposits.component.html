<app-loader *ngIf="this.isLoading"></app-loader>

<div class="container" fxLayout="column" fxLayoutGap="15px" *ngIf="!this.isLoading">

	<div fxLayout="column" fxFlex="auto" fxLayoutAlign="start" fxLayoutGap="15px">

		<div [ngClass]="{'emulated-flex-gap' : this.getThemingService().isSmallScreen}" fxLayout="row wrap" fxLayoutGap="0px" fxLayoutGap.gt-sm="15px grid" @transition>

				<!-- New Deposit -->
				<div id="cards" fxFlex="auto" fxFlex.gt-md="40">
					<form [formGroup]="deposit">
						<mat-card class="mat-elevation-z6">

							<mat-card-header fxLayout="column">
								<h2 class="title">New Deposit</h2>
							</mat-card-header>

							<mat-card-content fxLayout="column" fxLayoutGap="15px">

								<fieldset fxFlex fxLayout="column">
									<legend>Wallet for deposit</legend>
									<mat-form-field hintLabel="Select a wallet for this deposit" color="accent" appearance="fill" fxFlex>
										<mat-label>Wallet</mat-label>
										<mat-select #wallet name="wallet" formControlName="wallet" (selectionChange)="selectWallet($event.value)">
											<mat-option [value]="item.key" *ngFor="let item of this.wallets | keyvalue" >
												{{ this.getHelperService().formatAddress(item.key) + ' (' + this.getHelperService().formatAmount($any(item).value.balance, 1, 6) + ')' }}
											</mat-option>
										</mat-select>
										<mat-error *ngIf="deposit.controls.wallet.hasError('required')">
											Wallet is <strong>required</strong>
										</mat-error>
										<mat-error *ngIf="deposit.controls.wallet.hasError('minlength')">
											Address must be <strong>98 characters</strong>
										</mat-error>
									</mat-form-field>
								</fieldset>


								<fieldset fxFlex fxLayout="column">
									<legend>Amount to deposit</legend>

									<div fxLayout="column" fxFlex fxLayoutGap="25px">
										<mat-form-field hintLabel="Enter the amount you wish to deposit" color="accent" appearance="fill" fxFlex>
											<mat-label>Amount</mat-label>
											<input #amount matInput numeric steps="0" min="0" type="number" name="amount" placeholder="100" formControlName="amount">
											<span matSuffix>CCX</span>
											<mat-error *ngIf="deposit.controls.amount.hasError('required')">
												Amount is <strong>required</strong>
											</mat-error>
											<mat-error *ngIf="deposit.controls.amount.hasError('pattern')">
												Amount is <strong>not a valid</strong> number
											</mat-error>
										</mat-form-field>
										<div fxFlex fxLayout="row" fxLayoutAlign="space-between stretch" fxLayoutGap="15px">
											<button fxFlex color="accent" class="balance" mat-stroked-button aria-hidden="false" aria-label="Add 25% of balance" matTooltip="Add 25% of balance" matTooltipPosition="below" matTooltipClass="custom-tooltip" type="button" (click)="setAmount(25, wallet.value)" [disabled]="!this.selectedWallet">25%</button>
											<button fxFlex color="accent" class="balance" mat-stroked-button aria-hidden="false" aria-label="Add 50% of balance" matTooltip="Add 50% of balance" matTooltipPosition="below" matTooltipClass="custom-tooltip" type="button" (click)="setAmount(50, wallet.value)" [disabled]="!this.selectedWallet">50%</button>
											<button fxFlex color="accent" class="balance" mat-stroked-button aria-hidden="false" aria-label="Add 75% of balance" matTooltip="Add 75% of balance" matTooltipPosition="below" matTooltipClass="custom-tooltip" type="button" (click)="setAmount(75, wallet.value)" [disabled]="!this.selectedWallet">75%</button>
											<button fxFlex color="accent" class="balance" mat-stroked-button aria-hidden="false" aria-label="Add 100% of balance" matTooltip="Add 100% of balance" matTooltipPosition="below" matTooltipClass="custom-tooltip" type="button" (click)="setAmount(100, wallet.value)" [disabled]="!this.selectedWallet">Max</button>
										</div>
									</div>

								</fieldset>

								<fieldset fxFlex fxLayout="column">
									<legend>Length of deposit</legend>
									<div fxLayout="column" fxFlex fxLayoutGap="25px">
										<mat-form-field hintLabel="Select the term of the deposit in months" color="accent" appearance="fill" fxFlex>
											<mat-label>Term</mat-label>
											<input #term matInput numeric steps="1" min="1" max="12" type="number" name="term" placeholder="1" formControlName="term" (input)="termChanges(term.value)">
											<span matSuffix>Months</span>
										</mat-form-field>
									<mat-slider [value]="termLength" class="slider" color="accent" thumbLabel tickInterval="1" step="1" min="0" max="12" aria-label="units" (input)="termChanges($event.value)"></mat-slider>
									</div>
								</fieldset>

							</mat-card-content>

							<mat-card-actions fxLayout="column" fxLayoutAlign="stretch">
								<div class="actions" fxLayout="row" fxLayoutAlign="start" fxLayoutGap="15px">
									<button color="accent" mat-flat-button>Create Deposit</button>
									<button color="warn" mat-flat-button>Reset</button>
								</div>
							</mat-card-actions>

						</mat-card>
					</form>
				</div>

				<!-- Deposits Table -->
				<div id="cards" fxFlex="auto" fxFlex.gt-md="60">
					<mat-card class="mat-elevation-z6" fxFlex="100%">
						<mat-card-header fxLayout="column">
							<h2 class="title">Interest Matrix</h2>
						</mat-card-header>
						<mat-card-content fxLayout="column">

							<table mat-table [dataSource]="dataSource">
								<!--- Note that these columns can be defined in any order. The actual rendered columns are set as a property on the row definition" -->

								<!-- Position Column -->
								<ng-container matColumnDef="month">
									<th mat-header-cell *matHeaderCellDef>Term<br /></th>
									<td mat-cell *matCellDef="let element"> {{element.month}} Month<span *ngIf="element.month > 1">s</span></td>
								</ng-container>

								<!-- Name Column -->
								<ng-container matColumnDef="tier1">
									<th mat-header-cell *matHeaderCellDef>Tier 1<br /><span class="subtitle">< 10,000 CCX</span></th>
									<td mat-cell *matCellDef="let element"> {{element.tier1.toFixed(2)}}% </td>
								</ng-container>

								<!-- Weight Column -->
								<ng-container matColumnDef="tier2">
									<th mat-header-cell *matHeaderCellDef>Tier 2<br /><span class="subtitle">10,000 to 19,999 CCX</span></th>
									<td mat-cell *matCellDef="let element"> {{element.tier2.toFixed(2)}}% </td>
								</ng-container>

								<!-- Symbol Column -->
								<ng-container matColumnDef="tier3">
									<th mat-header-cell *matHeaderCellDef>Tier 3<br /><span class="subtitle">>= 20,000 CCX</span></th>
									<td mat-cell *matCellDef="let element"> {{element.tier3.toFixed(2)}}% </td>
								</ng-container>

								<tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
								<tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
							</table>

						</mat-card-content>
					</mat-card>
				</div>

		</div>

		<div [ngClass]="{'emulated-flex-gap' : this.getThemingService().isSmallScreen}" fxLayout="row wrap" fxLayoutGap="0px" fxLayoutGap.gt-sm="15px grid" @transition>

			<!-- Current Deposits -->
			<div id="cards" fxFlex="auto">
				<mat-card class="mat-elevation-z6" fxFlex="100%">
					<mat-card-header fxLayout="column">
						<h2 class="title">Active Deposits</h2>
					</mat-card-header>
					<mat-card-content fxLayout="column">
					</mat-card-content>
				</mat-card>
			</div>

			<!-- Deposit History -->
			<div id="cards" fxFlex="auto">
				<mat-card class="mat-elevation-z6" fxFlex="100%">
					<mat-card-header fxLayout="column">
						<h2 class="title">Deposit History</h2>
					</mat-card-header>
					<mat-card-content fxLayout="column">
					</mat-card-content>
				</mat-card>
			</div>

		</div>

	</div>

</div>